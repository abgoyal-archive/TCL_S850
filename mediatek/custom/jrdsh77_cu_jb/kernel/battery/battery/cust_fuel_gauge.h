#include <mach/mt_typedefs.h>

#define FGAUGE_VOLTAGE_FACTOR           2.44 // mV
#define FGAUGE_CURRENT_FACTOR           6.25 // uV/Rsns
#define FGAUGE_CURRENT_OFFSET_FACTOR    1.56 // uV/Rsns
#define FGAUGE_CAR_FACTOR               6.25 // uV/Rsns
#define FGAUGE_RSNS_FACTOR              0.02 // Ohm

//#define COMPASATE_OCV                   80 // mV for evb
#define COMPASATE_OCV                   40 // mV for phone

#define BATTERY_VOLTAGE_MINIMUM         3400
#define BATTERY_VOLTAGE_MAXIMUM         4200

#define BATTERY_CAPACITY_MAXIMUM        1789

#define TEMPERATURE_T0                  110
#define TEMPERATURE_T1                  0
#define TEMPERATURE_T2                  25
#define TEMPERATURE_T3                  50
#define TEMPERATURE_T                   255 // This should be fixed, never change the value

//#define BATT_CAPACITY                   1280
#define BATT_CAPACITY                   1800

#define ENABLE_SW_COULOMB_COUNTER       0 // 1 is enable, 0 is disable
//#define ENABLE_SW_COULOMB_COUNTER       1 // 1 is enable, 0 is disable

//#define FG_CURRENT_OFFSET_DISCHARGING 	31
#define FG_CURRENT_OFFSET_DISCHARGING 	0

#define FG_RESISTANCE 	20

#define FG_METER_RESISTANCE 	0
//#define FG_METER_RESISTANCE 	540 // current meter

//#define MAX_BOOTING_TIME_FGCURRENT	5*6 // 5 seconds, 6 points = 1s
#define MAX_BOOTING_TIME_FGCURRENT	1*10 // 10s

#if defined(CONFIG_POWER_EXT)
//#define OCV_BOARD_COMPESATE	32 //mV 
#define OCV_BOARD_COMPESATE	72 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
#else
//#define OCV_BOARD_COMPESATE	0 //mV 
//#define OCV_BOARD_COMPESATE	48 //mV 
//#define OCV_BOARD_COMPESATE	25 //mV 
#define OCV_BOARD_COMPESATE	0 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
//#define R_FG_BOARD_SLOPE	1057 //slope
//#define R_FG_BOARD_SLOPE	1075 //slope
#endif

#define Q_MAX_POS_50	1789
#define Q_MAX_POS_25	1800
#define Q_MAX_POS_0		1589
#define Q_MAX_NEG_10	909

#define Q_MAX_POS_50_H_CURRENT	1773
#define Q_MAX_POS_25_H_CURRENT	1770
#define Q_MAX_POS_0_H_CURRENT	1010
#define Q_MAX_NEG_10_H_CURRENT	179

#define R_FG_VALUE 				20 // mOhm, base is 20
#define CURRENT_DETECT_R_FG	100  //10mA

#define OSR_SELECT_7			0

#define CAR_TUNE_VALUE			89 //1.00

/////////////////////////////////////////////////////////////////////
// <DOD, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _BATTERY_PROFILE_STRUC
{
    kal_int32 percentage;
    kal_int32 voltage;
} BATTERY_PROFILE_STRUC, *BATTERY_PROFILE_STRUC_P;

typedef enum
{
    T1_0C,
    T2_25C,
    T3_50C
} PROFILE_TEMPERATURE;

// T0 -10C
BATTERY_PROFILE_STRUC battery_profile_t0[] =
{
	{0   , 4068},
	{3   , 4032},
	{7   , 4007},
	{10  , 3988},
	{13  , 3974},
	{16  , 3962},
	{20  , 3950},
	{23  , 3940},
	{26  , 3930},
	{30  , 3919},
	{33  , 3907},
	{36  , 3894},
	{39  , 3881},
	{43  , 3869},
	{46  , 3857},
	{49  , 3847},
	{53  , 3837},
	{56  , 3829},
	{59  , 3822},
	{62  , 3816},
	{66  , 3811},
	{69  , 3807},
	{71  , 3804},
	{74  , 3801},
	{76  , 3799},
	{78  , 3797},
	{79  , 3796},
	{81  , 3794},  
	{82  , 3793}, 
	{83  , 3792},
	{84  , 3791},
	{86  , 3791},  
	{87  , 3790},
	{87  , 3790},
	{88  , 3789},
	{89  , 3789},
	{90  , 3788},
	{91  , 3788},
	{91  , 3788},
	{92  , 3787},
	{92  , 3787},
	{93  , 3787},
	{94  , 3787},
	{94  , 3787},
	{94  , 3786},
	{95  , 3786},
	{95  , 3786},
	{96  , 3786},
        {96  , 3785},
        {96  , 3786},
        {97  , 3786},
        {97  , 3786},
        {97  , 3785},
        {98  , 3786},
        {98  , 3785},
        {98  , 3785},
        {98  , 3785},
        {99  , 3786},
        {99  , 3785},
        {99  , 3785},
        {99  , 3784},
        {100 , 3785},
        {100 , 3400}
};      
        
// T1 0C
BATTERY_PROFILE_STRUC battery_profile_t1[] =
{
	{0   , 4152},
	{2   , 4126},
	{4   , 4108},
	{6   , 4094},
	{7   , 4080},
	{9   , 4066},
	{11  , 4050},
	{13  , 4034},
	{15  , 4019},
	{17  , 4005},
	{19  , 3992},
	{21  , 3981},
	{23  , 3971},
	{24  , 3961},
	{26  , 3932},
	{32  , 3922},
	{34  , 3910},
	{36  , 3897},
	{38  , 3884},
	{39  , 3870},
	{41  , 3857},
	{43  , 3847},
	{45  , 3838},
	{47  , 3831},
	{49  , 3825},
	{51  , 3819},
	{53  , 3813},
	{54  , 3808},  
	{56  , 3804}, 
	{58  , 3800},
	{60  , 3796},
	{62  , 3793},  
	{64  , 3790},
	{66  , 3788},
	{68  , 3785},
	{69  , 3783},
	{71  , 3781},
	{73  , 3779},
	{75  , 3775},
	{77  , 3772},
	{79  , 3768},
	{81  , 3763},
	{83  , 3755},
	{85  , 3747},
	{86  , 3736},
	{88  , 3725},
	{90  , 3713},
	{92  , 3704},
        {93  , 3700},
        {94  , 3698},
        {95  , 3697},
        {95  , 3695},
        {96  , 3695},
        {97  , 3693},
        {97  , 3692},
        {98  , 3692},
        {98  , 3691},
        {98  , 3691},
        {99  , 3690},
        {99  , 3689},
        {99  , 3689},
        {100 , 3688},
        {100 , 3400}
               

}; 
// T2 25C
BATTERY_PROFILE_STRUC battery_profile_t2[] =
{
	{0   , 4184},
	{2   , 4166},
	{3   , 4149},
	{5   , 4134},
	{7   , 4119},
	{8   , 4106},
	{10  , 4091},
	{12  , 4079},
	{13  , 4065},
	{15  , 4051},
	{17  , 4037},
	{18  , 4023},
	{20  , 4010},
	{22  , 3998},
	{23  , 3986},
	{25  , 3975},
	{27  , 3966},
	{28  , 3957},
	{30  , 3948},
	{32  , 3938},
	{33  , 3929},
	{35  , 3919},
	{37  , 3911},
	{38  , 3900},
	{40  , 3885},
	{41  , 3869},
	{43  , 3853},
	{45  , 3843},  
	{46  , 3834}, 
	{48  , 3828},
	{50  , 3822},
	{51  , 3817},  
	{53  , 3811},
	{55  , 3805},
	{56  , 3802},
	{58  , 3798},
	{60  , 3793},
	{61  , 3790},
	{63  , 3785},
	{65  , 3782},
	{66  , 3779},
	{68  , 3776},
	{70  , 3773},
	{71  , 3770},
	{73  , 3766},
	{75  , 3761},
	{76  , 3755},
	{78  , 3747},
        {80  , 3740},
        {81  , 3733},
        {83  , 3720},
        {85  , 3706},
        {86  , 3691},
        {88  , 3686},
        {90  , 3684},
        {91  , 3683},
        {93  , 3679},
        {95  , 3675},
        {96  , 3640},
        {98  , 3570},
        {100 , 3460},
        {100 , 3346},
        {100 , 3323}
  

}; 

// T3 50C
BATTERY_PROFILE_STRUC battery_profile_t3[] =
{
	{0   , 4191},
	{2   , 4173},
	{3   , 4156},
	{5   , 4139},
	{7   , 4124},
	{8   , 4108},
	{10  , 4093},
	{12  , 4078},
	{13  , 4064},
	{15  , 4050},
	{17  , 4036},
	{18  , 4023},
	{20  , 4010},
	{22  , 3998},
	{23  , 3985},
	{25  , 3974},
	{27  , 3964},
	{28  , 3952},
	{30  , 3942},
	{32  , 3932},
	{33  , 3922},
	{35  , 3913},
	{37  , 3902},
	{38  , 3892},
	{40  , 3878},
	{42  , 3862},
	{43  , 3849},
	{45  , 3839},  
	{47  , 3831}, 
	{48  , 3824},
	{50  , 3818},
	{52  , 3811},  
	{53  , 3806},
	{55  , 3800},
	{57  , 3796},
	{58  , 3792},
	{60  , 3788},
	{62  , 3783},
	{63  , 3780},
	{65  , 3777},
	{67  , 3773},
	{68  , 3768},
	{70  , 3758},
	{72  , 3750},
	{73  , 3746},
	{75  , 3741},
	{77  , 3733},
	{78  , 3727},
        {80  , 3721},
        {82  , 3713},
        {83  , 3702},
        {85  , 3690},
        {87  , 3675},
        {88  , 3673},
        {90  , 3671},
        {92  , 3669},
        {93  , 3665},
        {95  , 3648},
        {97  , 3594},
        {98  , 3513},
        {100 , 3391},
        {100 , 3268},
        {100 , 3255}
  

};              

// battery profile for actual temperature. The size should be the same as T1, T2 and T3
BATTERY_PROFILE_STRUC battery_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0}
    
};    

/////////////////////////////////////////////////////////////////////
// <Rbat, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _R_PROFILE_STRUC
{
    kal_int32 resistance; // Ohm
    kal_int32 voltage;
} R_PROFILE_STRUC, *R_PROFILE_STRUC_P;

// T0 -10C
R_PROFILE_STRUC r_profile_t0[] =
{
	{343     ,  4068},
	{1260    ,  4032},
	{1325    ,  4007},
	{1355    ,  3988},
	{1373    ,  3974},
	{1390    ,  3962},
	{1398    ,  3950},
	{1415    ,  3940},
	{1428    ,  3930},
	{1440    ,  3919},
	{1445    ,  3907},
	{1455    ,  3894},
	{1458    ,  3881},
	{1460    ,  3869},
	{1460    ,  3857},
	{1465    ,  3847},
	{1475    ,  3837},
	{1475    ,  3829},
	{1490    ,  3822},
	{1500    ,  3816},
	{1513    ,  3811},
	{1518    ,  3807},
	{1513    ,  3804},
	{1503    ,  3801},
	{1500    ,  3799},
	{1493    ,  3797},
	{1490    ,  3796},
	{1488    ,  3794},  
	{1485    ,  3793}, 
	{1483    ,  3792},
	{1480    ,  3791},
	{1480    ,  3791},  
	{1478    ,  3790},
	{1475    ,  3790},
	{1473    ,  3789},
	{1475    ,  3789},
	{1473    ,  3788},
	{1473    ,  3788},
	{1470    ,  3788},
	{1470    ,  3787},
	{1470    ,  3787},
	{1470    ,  3787},
	{1470    ,  3787},
	{1470    ,  3787},
	{1468    ,  3786},
	{1470    ,  3786},
	{1465    ,  3786},
	{1468    ,  3786},
        {1468    ,  3785},
        {1468    ,  3786},
        {1468    ,  3786},
        {1465    ,  3786},
        {1468    ,  3785},
        {1470    ,  3786},
        {1465    ,  3785},
        {1468    ,  3785},
        {1468    ,  3785},
        {1470    ,  3786},
        {1470    ,  3785},
        {1465    ,  3785},
        {1465    ,  3784},
        {1468    ,  3785},
        {505     ,  3400}

};

// T1 0C
R_PROFILE_STRUC r_profile_t1[] =
{
	{220     ,  4152},
	{638     ,  4126},
	{663     ,  4108},
	{678     ,  4094},
	{690     ,  4080},
	{703     ,  4066},
	{720     ,  4050},
	{735     ,  4034},
	{748     ,  4019},
	{760     ,  4005},
	{773     ,  3992},
	{785     ,  3981},
	{798     ,  3971},
	{815     ,  3961},
	{775     ,  3932},
	{860     ,  3922},
	{865     ,  3910},
	{868     ,  3897},
	{870     ,  3884},
	{870     ,  3870},
	{868     ,  3857},
	{875     ,  3847},
	{880     ,  3838},
	{888     ,  3831},
	{898     ,  3825},
	{910     ,  3819},
	{915     ,  3813},
	{930     ,  3808},
	{945     ,  3804},
	{955     ,  3800},
	{968     ,  3796},
	{975     ,  3793},
	{998     ,  3790},
	{1010    ,  3788},
	{1035    ,  3785},
	{1053    ,  3783},
	{1078    ,  3781},
	{1098    ,  3779},
	{1118    ,  3775},
	{1138    ,  3772},
	{1163    ,  3768},
	{1178    ,  3763},
	{1193    ,  3755},
	{1208    ,  3747},
	{1218    ,  3736},
	{1240    ,  3725},
	{1255    ,  3713},
	{1260    ,  3704},
        {1250    ,  3700},
        {1245    ,  3698},
        {1245    ,  3697},
        {1238    ,  3695},
        {1238    ,  3695},
        {1235    ,  3693},
        {1230    ,  3692},
        {1233    ,  3692},
        {1228    ,  3691},
        {1228    ,  3691},
        {1228    ,  3690},
        {1223    ,  3689},
        {1228    ,  3689},
        {1223    ,  3688},
        {503     ,  3400} 


}; 

// T2 25C
R_PROFILE_STRUC r_profile_t2[] =
{
	{143    ,  4184},
	{190    ,  4166},
	{190    ,  4149},
	{193    ,  4134},
	{193    ,  4119},
	{198    ,  4106},
	{195    ,  4091},
	{198    ,  4079},
	{195    ,  4065},
	{193    ,  4051},
	{195    ,  4037},
	{193    ,  4023},
	{193    ,  4010},
	{193    ,  3998},
	{190    ,  3986},
	{193    ,  3975},
	{198    ,  3966},
	{203    ,  3957},
	{205    ,  3948},
	{208    ,  3938},
	{213    ,  3929},
	{218    ,  3919},
	{228    ,  3911},
	{228    ,  3900},
	{220    ,  3885},
	{210    ,  3869},
	{198    ,  3853},
	{198    ,  3843},
	{198    ,  3834},
	{200    ,  3828},
	{205    ,  3822},
	{210    ,  3817},
	{213    ,  3811},
	{213    ,  3805},
	{218    ,  3802},
	{220    ,  3798},
	{215    ,  3793},
	{218    ,  3790},
	{213    ,  3785},
	{215    ,  3782},
	{213    ,  3779},
	{210    ,  3776},
	{210    ,  3773},
	{210    ,  3770},
	{213    ,  3766},
	{220    ,  3761},
	{223    ,  3755},
	{228    ,  3747},
        {238    ,  3740},
        {250    ,  3733},
        {248    ,  3720},
        {250    ,  3706},
        {250    ,  3691},
        {248    ,  3686},
        {253    ,  3684},
        {268    ,  3683},
        {280    ,  3679},
        {300    ,  3675},
        {293    ,  3640},
        {315    ,  3570},
        {345    ,  3460},
        {368    ,  3346},
        {313    ,  3323} 


};

// T3 50C
R_PROFILE_STRUC r_profile_t3[] =
{
	{128    ,  4191},
	{128    ,  4173},
	{128    ,  4156},
	{128    ,  4139},
	{130    ,  4124},
	{133    ,  4108},
	{130    ,  4093},
	{130    ,  4078},
	{133    ,  4064},
	{133    ,  4050},
	{133    ,  4036},
	{135    ,  4023},
	{135    ,  4010},
	{138    ,  3998},
	{135    ,  3985},
	{138    ,  3974},
	{140    ,  3964},
	{140    ,  3952},
	{145    ,  3942},
	{148    ,  3932},
	{150    ,  3922},
	{155    ,  3913},
	{160    ,  3902},
	{165    ,  3892},
	{155    ,  3878},
	{145    ,  3862},
	{140    ,  3849},
	{133    ,  3839},
	{133    ,  3831},
	{135    ,  3824},
	{135    ,  3818},
	{133    ,  3811},
	{135    ,  3806},
	{135    ,  3800},
	{135    ,  3796},
	{138    ,  3792},
	{140    ,  3788},
	{140    ,  3783},
	{140    ,  3780},
	{145    ,  3777},
	{145    ,  3773},
	{143    ,  3768},
	{133    ,  3758},
	{133    ,  3750},
	{138    ,  3746},
	{133    ,  3741},
	{133    ,  3733},
	{133    ,  3727},
        {133    ,  3721},
        {133    ,  3713},
        {133    ,  3702},
        {130    ,  3690},
        {128    ,  3675},
        {130    ,  3673},
        {135    ,  3671},
        {138    ,  3669},
        {138    ,  3665},
        {143    ,  3648},
        {150    ,  3594},
        {153    ,  3513},
        {160    ,  3391},
        {173    ,  3268},
        {140    ,  3255} 



};

// r-table profile for actual temperature. The size should be the same as T1, T2 and T3
R_PROFILE_STRUC r_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0}
    
};    


int fgauge_get_saddles(void);
BATTERY_PROFILE_STRUC_P fgauge_get_profile(kal_uint32 temperature);

int fgauge_get_saddles_r_table(void);
R_PROFILE_STRUC_P fgauge_get_profile_r_table(kal_uint32 temperature);
